import{_ as s}from"./plugin-vue_export-helper.21dcd24c.js";import{o as n,c as e,e as a}from"./app.17fe08ce.js";const l={},i=a(`<h1 id="redis" tabindex="-1"><a class="header-anchor" href="#redis" aria-hidden="true">#</a> redis</h1><h3 id="\u7F16\u8BD1redis" tabindex="-1"><a class="header-anchor" href="#\u7F16\u8BD1redis" aria-hidden="true">#</a> \u7F16\u8BD1redis</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">make</span> <span class="token assign-left variable">PREFIX</span><span class="token operator">=</span>/web/software/redis-5.0.14 <span class="token function">install</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u542F\u52A8redis-server" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8redis-server" aria-hidden="true">#</a> \u542F\u52A8redis-server</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u914D\u7F6E\u540E\u53F0\u542F\u52A8\uFF0C\u4E14\u7AEF\u53E3\u662F 6381</span>
redis-server ./redis.conf <span class="token parameter variable">--daemonize</span> <span class="token function">yes</span> <span class="token parameter variable">--port</span> <span class="token number">6381</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u8FDE\u63A5redis" tabindex="-1"><a class="header-anchor" href="#\u8FDE\u63A5redis" aria-hidden="true">#</a> \u8FDE\u63A5redis</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>redis-cli <span class="token parameter variable">-h</span> <span class="token function">hostname</span> <span class="token parameter variable">-p</span> <span class="token number">6381</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u67E5\u770Bredis\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770Bredis\u72B6\u6001" aria-hidden="true">#</a> \u67E5\u770Bredis\u72B6\u6001</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token operator">&gt;</span>info all
<span class="token operator">&gt;</span>info Stats
connected_clients:68  <span class="token comment">#\u8FDE\u63A5\u7684\u5BA2\u6237\u7AEF\u6570\u91CF</span>
used_memory_rss_human:847.62M <span class="token comment">#\u7CFB\u7EDF\u7ED9redis\u5206\u914D\u7684\u5185\u5B58</span>
used_memory_peak_human:794.42M  <span class="token comment">#\u5185\u5B58\u4F7F\u7528\u7684\u5CF0\u503C\u5927\u5C0F</span>
total_connections_received:619104 <span class="token comment">#\u670D\u52A1\u5668\u5DF2\u63A5\u53D7\u7684\u8FDE\u63A5\u8BF7\u6C42\u6570\u91CF</span>
instantaneous_ops_per_sec:1159 <span class="token comment">#\u670D\u52A1\u5668\u6BCF\u79D2\u949F\u6267\u884C\u7684\u547D\u4EE4\u6570\u91CF</span>
instantaneous_input_kbps:55.85 <span class="token comment">#redis\u7F51\u7EDC\u5165\u53E3kps</span>
instantaneous_output_kbps:3553.89 <span class="token comment">#redis\u7F51\u7EDC\u51FA\u53E3kps</span>
rejected_connections:0 <span class="token comment">#\u56E0\u4E3A\u6700\u5927\u5BA2\u6237\u7AEF\u6570\u91CF\u9650\u5236\u800C\u88AB\u62D2\u7EDD\u7684\u8FDE\u63A5\u8BF7\u6C42\u6570\u91CF</span>
expired_keys:0 <span class="token comment">#\u56E0\u4E3A\u8FC7\u671F\u800C\u88AB\u81EA\u52A8\u5220\u9664\u7684\u6570\u636E\u5E93\u952E\u6570\u91CF</span>
evicted_keys:0 <span class="token comment">#\u56E0\u4E3A\u6700\u5927\u5185\u5B58\u5BB9\u91CF\u9650\u5236\u800C\u88AB\u9A71\u9010\uFF08evict\uFF09\u7684\u952E\u6570\u91CF</span>
keyspace_hits:0 <span class="token comment">#\u67E5\u627E\u6570\u636E\u5E93\u952E\u6210\u529F\u7684\u6B21\u6570</span>
keyspace_misses:0 <span class="token comment">#\u67E5\u627E\u6570\u636E\u5E93\u952E\u5931\u8D25\u7684\u6B21\u6570</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u6570\u636E\u7C7B\u578B" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u7C7B\u578B" aria-hidden="true">#</a> \u6570\u636E\u7C7B\u578B</h3><p>Redis\u652F\u6301\u4E94\u79CD\u6570\u636E\u7C7B\u578B\uFF1Astring\uFF08\u5B57\u7B26\u4E32\uFF09\uFF0Chash\uFF08\u54C8\u5E0C\uFF09\uFF0Clist\uFF08\u5217\u8868\uFF09\uFF0Cset\uFF08\u96C6\u5408\uFF09\u53CAzset(sorted set\uFF1A\u6709\u5E8F\u96C6\u5408)\u3002</p><h3 id="\u57FA\u7840\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#\u57FA\u7840\u547D\u4EE4" aria-hidden="true">#</a> \u57FA\u7840\u547D\u4EE4</h3><p>\u67E5\u770B\u6240\u6709key</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>127.0.0.1:6379&gt;KEYS pattern
127.0.0.1:6379&gt;KEYS *
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u67E5\u770B\u5F53\u524Dredis\u7684\u914D\u7F6E\u6587\u4EF6</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>redis-cli info <span class="token operator">|</span> <span class="token function">grep</span> config
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="string\u7C7B\u578B" tabindex="-1"><a class="header-anchor" href="#string\u7C7B\u578B" aria-hidden="true">#</a> string\u7C7B\u578B</h4><p>\u8BBE\u7F6E\u3001\u83B7\u53D6\u3001\u5220\u9664\u5355\u4E2A\u503C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> key1
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get key1
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> del key1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6279\u91CF\u83B7\u53D6\u3001\u8BBE\u7F6E\u503C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> mset key1 <span class="token string">&quot;Hello&quot;</span> key2 <span class="token string">&quot;World&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> mget key1 key2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8BBE\u7F6E\u6709\u5B9E\u6548\u7684\u6570\u636E</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setex key1 <span class="token number">10</span> value
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> psetex key1 <span class="token number">10</span> value
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FFD\u52A0\u6570\u636E</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> append key1 value
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u81EA\u589E\u81EA\u51CF</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> incr key1
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> decr key1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6307\u5B9A\u6570\u91CF\u81EA\u589E\u81EA\u51CF</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> incrby key1
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> decrby key1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="hash\u7C7B\u578B" tabindex="-1"><a class="header-anchor" href="#hash\u7C7B\u578B" aria-hidden="true">#</a> hash\u7C7B\u578B</h4><p>\u8BBE\u7F6E\u3001\u83B7\u53D6\u3001\u5220\u9664\u6570\u636E</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hset key field value
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hget key field 
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hgetall key 
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hdel key field1 field2 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u83B7\u53D6\u54C8\u5E0C\u8868\u91CC\u7684\u5B57\u6BB5\u540D\u6216\u8005\u5B57\u6BB5\u503C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hkeys key
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hvals key
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u54C8\u5E0C\u8868\u81EA\u589E\u81EA\u51CF\u4E00\u4E2A\u6307\u5B9A\u6570\u503C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hincrby key field <span class="token number">10</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u67E5\u770Bredis\u72B6\u6001-1" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770Bredis\u72B6\u6001-1" aria-hidden="true">#</a> \u67E5\u770Bredis\u72B6\u6001</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl status redis-server
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>connected_clients:68  <span class="token comment">#\u8FDE\u63A5\u7684\u5BA2\u6237\u7AEF\u6570\u91CF</span>
used_memory_rss_human:847.62M <span class="token comment">#\u7CFB\u7EDF\u7ED9redis\u5206\u914D\u7684\u5185\u5B58</span>
used_memory_peak_human:794.42M  <span class="token comment">#\u5185\u5B58\u4F7F\u7528\u7684\u5CF0\u503C\u5927\u5C0F</span>
total_connections_received:619104 <span class="token comment">#\u670D\u52A1\u5668\u5DF2\u63A5\u53D7\u7684\u8FDE\u63A5\u8BF7\u6C42\u6570\u91CF</span>
instantaneous_ops_per_sec:1159 <span class="token comment">#\u670D\u52A1\u5668\u6BCF\u79D2\u949F\u6267\u884C\u7684\u547D\u4EE4\u6570\u91CF</span>
instantaneous_input_kbps:55.85 <span class="token comment">#redis\u7F51\u7EDC\u5165\u53E3kps</span>
instantaneous_output_kbps:3553.89 <span class="token comment">#redis\u7F51\u7EDC\u51FA\u53E3kps</span>
rejected_connections:0 <span class="token comment">#\u56E0\u4E3A\u6700\u5927\u5BA2\u6237\u7AEF\u6570\u91CF\u9650\u5236\u800C\u88AB\u62D2\u7EDD\u7684\u8FDE\u63A5\u8BF7\u6C42\u6570\u91CF</span>
expired_keys:0 <span class="token comment">#\u56E0\u4E3A\u8FC7\u671F\u800C\u88AB\u81EA\u52A8\u5220\u9664\u7684\u6570\u636E\u5E93\u952E\u6570\u91CF</span>
evicted_keys:0 <span class="token comment">#\u56E0\u4E3A\u6700\u5927\u5185\u5B58\u5BB9\u91CF\u9650\u5236\u800C\u88AB\u9A71\u9010\uFF08evict\uFF09\u7684\u952E\u6570\u91CF</span>
keyspace_hits:0 <span class="token comment">#\u67E5\u627E\u6570\u636E\u5E93\u952E\u6210\u529F\u7684\u6B21\u6570</span>
keyspace_misses:0 <span class="token comment">#\u67E5\u627E\u6570\u636E\u5E93\u952E\u5931\u8D25\u7684\u6B21\u6570</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="redis\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#redis\u96C6\u7FA4" aria-hidden="true">#</a> redis\u96C6\u7FA4</h2><blockquote><p>\u96C6\u7FA4\u914D\u7F6E\u6587\u4EF6\u8DEF\u5F84\uFF1A/web/bcshell/cache/redis/redisCluster</p><p>\u5176\u4E2D\u4E00\u4E2A\u4E3B\u8282\u70B9\u914D\u7F6E\u4E00\u4E2A\u4ECE\u8282\u70B9\u914D\u7F6Eredis_145_master.conf redis_137_slave.conf</p><p>\u91C7\u7528\u9519\u5F00\u90E8\u7F72\u65B9\u5F0F\uFF0C145\u4E00\u4E2A\u4E3B\u8282\u70B9\u4E00\u4E2A134\u7684\u4ECE\u8282\u70B9\uFF0C137\u4E00\u4E2A\u4E3B\u8282\u70B9\u4E00\u4E2A136\u7684\u4ECE\u8282\u70B9\uFF0C136\u4E00\u4E2A\u4E3B\u8282\u70B9\u4E00\u4E2A137\u7684\u4ECE\u8282\u70B9\uFF0C134\u4E00\u4E2A\u4E3B\u8282\u70B9\u4E00\u4E2A145\u7684\u4ECE\u8282\u70B9\uFF0C\u4F5C\u7528\u662F\u5176\u4E2D\u4EFB\u4F55\u4E00\u53F0\u5B95\u673A\u90FD\u4E0D\u4F1A\u5F71\u54CDredis\u6B63\u5E38\u8FD0\u884C\u3002</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u7AEF\u53E3</span>
port <span class="token number">6850</span>
<span class="token comment"># \u542F\u7528\u96C6\u7FA4\u6A21\u5F0F</span>
cluster-enabled <span class="token function">yes</span> 
<span class="token comment"># \u6839\u636E\u4F60\u542F\u7528\u7684\u8282\u70B9\u6765\u547D\u540D\uFF0C\u6700\u597D\u548C\u7AEF\u53E3\u4FDD\u6301\u4E00\u81F4\uFF0C\u8FD9\u4E2A\u662F\u7528\u6765\u4FDD\u5B58\u5176\u4ED6\u8282\u70B9\u7684\u540D\u79F0\uFF0C\u72B6\u6001\u7B49\u4FE1\u606F\u7684</span>
cluster-config-file nodes_136_6850.conf 
<span class="token comment"># \u8D85\u65F6\u65F6\u95F4</span>
cluster-node-timeout <span class="token number">5000</span>
appendonly <span class="token function">yes</span>
<span class="token comment"># \u540E\u53F0\u8FD0\u884C</span>
daemonize <span class="token function">yes</span>
<span class="token comment"># \u975E\u4FDD\u62A4\u6A21\u5F0F</span>
protected-mode no 
<span class="token comment"># \u6700\u5927\u5185\u5B58</span>
maxmemory 4096M
<span class="token comment"># lru\u6A21\u5F0F</span>
maxmemory-policy allkeys-lru

pidfile  /var/run/redis_6850.pid
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u521B\u5EFA\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFA\u96C6\u7FA4" aria-hidden="true">#</a> \u521B\u5EFA\u96C6\u7FA4</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#--cluster-replicas 1\u53C2\u6570\u8868\u793A\u6BCF\u4E2A\u4E3B\u8282\u70B9\u540E\u9762\u81EA\u52A8\u521B\u5EFA\u4ECE\u8282\u70B9</span>
redis-cli <span class="token parameter variable">--cluster</span> create <span class="token number">192.168</span>.2.145:6850 <span class="token number">192.168</span>.2.137:6850 <span class="token number">192.168</span>.2.136:6850 <span class="token number">192.168</span>.2.136:6851 <span class="token number">192.168</span>.2.137:6851 <span class="token number">192.168</span>.2.145:6851 --cluster-replicas <span class="token number">1</span>

redis-cli <span class="token parameter variable">--cluster</span> create <span class="token number">192.168</span>.1.35:7001 <span class="token number">192.168</span>.1.35:7002 <span class="token number">192.168</span>.1.35:7003 <span class="token number">192.168</span>.1.35:7004 <span class="token number">192.168</span>.1.35:7005 <span class="token number">192.168</span>.1.35:7006 --cluster-replicas <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u6B63\u5F0F\u521B\u5EFA\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u6B63\u5F0F\u521B\u5EFA\u6D41\u7A0B" aria-hidden="true">#</a> \u6B63\u5F0F\u521B\u5EFA\u6D41\u7A0B</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#\u53EA\u521B\u5EFA\u56DB\u4E2A\u4E3B\u8282\u70B9\uFF0C\u4ECE\u8282\u70B9\u624B\u52A8\u914D\u7F6E(\u4E3A\u4E86\u6307\u5B9A\u4ECE\u8282\u70B9)\uFF0C\u6DFB\u52A0\u4ECE\u8282\u70B9\u5230\u4E3B\u8282\u70B9\u65F6\u4E0D\u9700\u8981\u5206\u914D\u69FD\uFF0C\u6DFB\u52A0\u4E3B\u8282\u70B9\u624D\u9700\u8981</span>
redis-cli <span class="token parameter variable">--cluster</span> create <span class="token number">192.168</span>.2.145:6850 <span class="token number">192.168</span>.2.134:6850 <span class="token number">192.168</span>.2.136:6850 <span class="token number">192.168</span>.2.137:6850

<span class="token comment">#\u6DFB\u52A0\u4ECE\u8282\u70B9\u5230\u4E3B\u8282\u70B9\uFF0C\u5148\u67E5\u4E00\u904D\u4E3B\u8282\u70B9id\u5217\u8868</span>
<span class="token number">192.168</span>.2.145:685<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> cluster nodes
2e33878a625c2593c82438245152575c80fe9f4e <span class="token number">192.168</span>.2.134:6850@16850 master - <span class="token number">0</span> <span class="token number">1642588068170</span> <span class="token number">2</span> connected <span class="token number">4096</span>-8191
0e6a6ce1f1cda274d37eb9038b6040e50889b6f8 <span class="token number">192.168</span>.2.136:6850@16850 master - <span class="token number">0</span> <span class="token number">1642588067168</span> <span class="token number">3</span> connected <span class="token number">8192</span>-12287
6444c437523ebd5e8a359181749b2f737ad55040 <span class="token number">192.168</span>.2.137:6850@16850 master - <span class="token number">0</span> <span class="token number">1642588068670</span> <span class="token number">4</span> connected <span class="token number">12288</span>-16383
9dc220f824f1e8a244721f7dac186d0ea3bf743c <span class="token number">192.168</span>.2.145:6850@16850 myself,master - <span class="token number">0</span> <span class="token number">1642588066000</span> <span class="token number">1</span> connected <span class="token number">0</span>-4095

<span class="token comment">#134:6851\u6DFB\u52A0\u4E3A145:6850\u4ECE\u8282\u70B9</span>
redis-cli <span class="token parameter variable">--cluster</span> add-node <span class="token number">192.168</span>.2.134:6851 <span class="token number">192.168</span>.2.145:6850 --cluster-slave --cluster-master-id 9dc220f824f1e8a244721f7dac186d0ea3bf743c

<span class="token comment">#145:6851\u6DFB\u52A0\u4E3A134:6850\u4ECE\u8282\u70B9</span>
redis-cli <span class="token parameter variable">--cluster</span> add-node <span class="token number">192.168</span>.2.145:6851 <span class="token number">192.168</span>.2.145:6850 --cluster-slave --cluster-master-id 2e33878a625c2593c82438245152575c80fe9f4e

<span class="token comment">#136:6851\u6DFB\u52A0\u4E3A137:6850\u4ECE\u8282\u70B9</span>
redis-cli <span class="token parameter variable">--cluster</span> add-node <span class="token number">192.168</span>.2.136:6851 <span class="token number">192.168</span>.2.145:6850 --cluster-slave --cluster-master-id 6444c437523ebd5e8a359181749b2f737ad55040

<span class="token comment">#137:6851\u6DFB\u52A0\u4E3A136:6850\u4ECE\u8282\u70B9</span>
redis-cli <span class="token parameter variable">--cluster</span> add-node <span class="token number">192.168</span>.2.137:6851 <span class="token number">192.168</span>.2.145:6850 --cluster-slave --cluster-master-id 0e6a6ce1f1cda274d37eb9038b6040e50889b6f8

<span class="token comment">#\u6CE8\u91CA\uFF1A</span>
<span class="token comment">#--cluster-slave\uFF0C\u8868\u793A\u6DFB\u52A0\u7684\u662F\u4ECE\u8282\u70B9</span>
<span class="token comment">#--cluster-master-id 9dc220f824f1e8a244721f7dac186d0ea3bf743c,\u4E3B\u8282\u70B9\u7684node id</span>
<span class="token comment">#192.168.2.134:6851,\u65B0\u8282\u70B9</span>
<span class="token comment">#192.168.2.145:6850\u96C6\u7FA4\u4EFB\u4E00\u4E2A\u4E3B\u8282\u70B9</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6DFB\u52A0\u540E\u67E5\u770B\u4E0B\u8282\u70B9\u5982\u4E0B\uFF0C\u56DB\u4E3B\u56DB\u4ECE\u914D\u7F6E\u6210\u529F</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">192.168</span>.2.145:685<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> cluster nodes
0e6a6ce1f1cda274d37eb9038b6040e50889b6f8 <span class="token number">192.168</span>.2.136:6850@16850 master - <span class="token number">0</span> <span class="token number">1642589271961</span> <span class="token number">3</span> connected <span class="token number">8192</span>-12287
2e33878a625c2593c82438245152575c80fe9f4e <span class="token number">192.168</span>.2.134:6850@16850 master - <span class="token number">0</span> <span class="token number">1642589271458</span> <span class="token number">2</span> connected <span class="token number">4096</span>-8191
d493956d2fb46575e3ed4ee53a64f8ab5edfd97b <span class="token number">192.168</span>.2.145:6851@16851 slave 2e33878a625c2593c82438245152575c80fe9f4e <span class="token number">0</span> <span class="token number">1642589273462</span> <span class="token number">2</span> connected
d4771a0b28c54652673c624216d3e08ba0cfe678 <span class="token number">192.168</span>.2.137:6851@16851 slave 0e6a6ce1f1cda274d37eb9038b6040e50889b6f8 <span class="token number">0</span> <span class="token number">1642589271000</span> <span class="token number">3</span> connected
9dc220f824f1e8a244721f7dac186d0ea3bf743c <span class="token number">192.168</span>.2.145:6850@16850 myself,master - <span class="token number">0</span> <span class="token number">1642589269000</span> <span class="token number">1</span> connected <span class="token number">0</span>-4095
99f84ea83b2e42eaf35a899cfdae86a8a31b739d <span class="token number">192.168</span>.2.136:6851@16851 slave 6444c437523ebd5e8a359181749b2f737ad55040 <span class="token number">0</span> <span class="token number">1642589272000</span> <span class="token number">4</span> connected
4310ce12de0382bcdcc22dcd2f865ac95ec81d61 <span class="token number">192.168</span>.2.134:6851@16851 slave 9dc220f824f1e8a244721f7dac186d0ea3bf743c <span class="token number">0</span> <span class="token number">1642589272461</span> <span class="token number">1</span> connected
6444c437523ebd5e8a359181749b2f737ad55040 <span class="token number">192.168</span>.2.137:6850@16850 master - <span class="token number">0</span> <span class="token number">1642589271000</span> <span class="token number">4</span> connected <span class="token number">12288</span>-16383
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u64CD\u4F5C\u96C6\u7FA4-\u8FDB\u5165\u96C6\u7FA4\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#\u64CD\u4F5C\u96C6\u7FA4-\u8FDB\u5165\u96C6\u7FA4\u64CD\u4F5C" aria-hidden="true">#</a> \u64CD\u4F5C\u96C6\u7FA4\uFF08\u8FDB\u5165\u96C6\u7FA4\u64CD\u4F5C\uFF09</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#\u96C6\u7FA4(cluster) </span>
<span class="token number">1</span>. CLUSTER INFO \u6253\u5370\u96C6\u7FA4\u7684\u4FE1\u606F 
<span class="token number">2</span>. CLUSTER NODES \u5217\u51FA\u96C6\u7FA4\u5F53\u524D\u5DF2\u77E5\u7684\u6240\u6709\u8282\u70B9\uFF08node\uFF09\uFF0C\u4EE5\u53CA\u8FD9\u4E9B\u8282\u70B9\u7684\u76F8\u5173\u4FE1\u606F\u3002  
<span class="token number">3</span>. CLUSTER MEET <span class="token operator">&lt;</span>ip<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>port<span class="token operator">&gt;</span> \u5C06 <span class="token function">ip</span> \u548C port \u6240\u6307\u5B9A\u7684\u8282\u70B9\u6DFB\u52A0\u5230\u96C6\u7FA4\u5F53\u4E2D\uFF0C\u8BA9\u5B83\u6210\u4E3A\u96C6\u7FA4\u7684\u4E00\u4EFD\u5B50\u3002 
<span class="token number">4</span>. CLUSTER FORGET <span class="token operator">&lt;</span>node_id<span class="token operator">&gt;</span> \u4ECE\u96C6\u7FA4\u4E2D\u79FB\u9664 node_id \u6307\u5B9A\u7684\u8282\u70B9\u3002 
<span class="token number">5</span>. CLUSTER REPLICATE <span class="token operator">&lt;</span>node_id<span class="token operator">&gt;</span> \u5C06\u5F53\u524D\u8282\u70B9\u8BBE\u7F6E\u4E3A node_id \u6307\u5B9A\u7684\u8282\u70B9\u7684\u4ECE\u8282\u70B9\u3002 
<span class="token number">6</span>. CLUSTER SAVECONFIG \u5C06\u8282\u70B9\u7684\u914D\u7F6E\u6587\u4EF6\u4FDD\u5B58\u5230\u786C\u76D8\u91CC\u9762\u3002  

<span class="token comment">#\u69FD(slot) </span>
<span class="token number">1</span>. CLUSTER ADDSLOTS <span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span> <span class="token punctuation">[</span>slot <span class="token punctuation">..</span>.<span class="token punctuation">]</span> \u5C06\u4E00\u4E2A\u6216\u591A\u4E2A\u69FD\uFF08slot\uFF09\u6307\u6D3E\uFF08assign\uFF09\u7ED9\u5F53\u524D\u8282\u70B9\u3002 
<span class="token number">2</span>. CLUSTER DELSLOTS <span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span> <span class="token punctuation">[</span>slot <span class="token punctuation">..</span>.<span class="token punctuation">]</span> \u79FB\u9664\u4E00\u4E2A\u6216\u591A\u4E2A\u69FD\u5BF9\u5F53\u524D\u8282\u70B9\u7684\u6307\u6D3E\u3002 
<span class="token number">3</span>. CLUSTER FLUSHSLOTS \u79FB\u9664\u6307\u6D3E\u7ED9\u5F53\u524D\u8282\u70B9\u7684\u6240\u6709\u69FD\uFF0C\u8BA9\u5F53\u524D\u8282\u70B9\u53D8\u6210\u4E00\u4E2A\u6CA1\u6709\u6307\u6D3E\u4EFB\u4F55\u69FD\u7684\u8282\u70B9\u3002 
<span class="token number">4</span>. CLUSTER SETSLOT <span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span> NODE <span class="token operator">&lt;</span>node_id<span class="token operator">&gt;</span> \u5C06\u69FD slot \u6307\u6D3E\u7ED9 node_id \u6307\u5B9A\u7684\u8282\u70B9\uFF0C\u5982\u679C\u69FD\u5DF2\u7ECF\u6307\u6D3E\u7ED9\u53E6\u4E00\u4E2A\u8282\u70B9\uFF0C\u90A3\u4E48\u5148\u8BA9\u53E6\u4E00\u4E2A\u8282\u70B9\u5220\u9664\u8BE5\u69FD<span class="token operator">&gt;</span>\uFF0C\u7136\u540E\u518D\u8FDB\u884C\u6307\u6D3E\u3002 
<span class="token number">5</span>. CLUSTER SETSLOT <span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span> MIGRATING <span class="token operator">&lt;</span>node_id<span class="token operator">&gt;</span> \u5C06\u672C\u8282\u70B9\u7684\u69FD slot \u8FC1\u79FB\u5230 node_id \u6307\u5B9A\u7684\u8282\u70B9\u4E2D\u3002 
<span class="token number">6</span>. CLUSTER SETSLOT <span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span> IMPORTING <span class="token operator">&lt;</span>node_id<span class="token operator">&gt;</span> \u4ECE node_id \u6307\u5B9A\u7684\u8282\u70B9\u4E2D\u5BFC\u5165\u69FD slot \u5230\u672C\u8282\u70B9\u3002 
<span class="token number">7</span>. CLUSTER SETSLOT <span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span> STABLE \u53D6\u6D88\u5BF9\u69FD slot \u7684\u5BFC\u5165\uFF08import\uFF09\u6216\u8005\u8FC1\u79FB\uFF08migrate\uFF09\u3002  
<span class="token number">8</span>.  

<span class="token comment">#\u952E (key) </span>
<span class="token number">1</span>. CLUSTER KEYSLOT <span class="token operator">&lt;</span>key<span class="token operator">&gt;</span> \u8BA1\u7B97\u952E key \u5E94\u8BE5\u88AB\u653E\u7F6E\u5728\u54EA\u4E2A\u69FD\u4E0A\u3002 
<span class="token number">2</span>. CLUSTER COUNTKEYSINSLOT <span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span> \u8FD4\u56DE\u69FD slot \u76EE\u524D\u5305\u542B\u7684\u952E\u503C\u5BF9\u6570\u91CF\u3002 
<span class="token number">3</span>. CLUSTER GETKEYSINSLOT <span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>count<span class="token operator">&gt;</span> \u8FD4\u56DE count \u4E2A slot \u69FD\u4E2D\u7684\u952E\u3002 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u96C6\u7FA4\u5F02\u5E38\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#\u96C6\u7FA4\u5F02\u5E38\u5904\u7406" aria-hidden="true">#</a> \u96C6\u7FA4\u5F02\u5E38\u5904\u7406</h3><p>\u67E5\u770B\u96C6\u7FA4\u72B6\u6001</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>redis-cli <span class="token parameter variable">--cluster</span> check <span class="token number">192.168</span>.2.145:6850
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4FEE\u590D\u96C6\u7FA4slot\u69FD\u4E22\u5931\u95EE\u9898</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>redis-cli <span class="token parameter variable">--cluster</span> fix <span class="token number">192.168</span>.2.145:6850
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u81EA\u52A8\u5E73\u8861\u96C6\u7FA4\u4E2D\u7684\u5404\u8282\u70B9\u54C8\u5E0C\u69FD\u6570</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>redis-cli <span class="token parameter variable">--cluster</span> rebalance --cluster-use-empty-masters <span class="token number">192.168</span>.2.145:6850
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u6DFB\u52A0\u4E00\u4E2A\u65B0\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#\u6DFB\u52A0\u4E00\u4E2A\u65B0\u8282\u70B9" aria-hidden="true">#</a> \u6DFB\u52A0\u4E00\u4E2A\u65B0\u8282\u70B9</h3><p>\u6DFB\u52A0\u4E3B\u8282\u70B9</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>redis-cli <span class="token parameter variable">--cluster</span> add-node <span class="token number">192.168</span>.2.134:6850 <span class="token number">192.168</span>.2.136:6850
<span class="token comment">#\u6CE8\u91CA\uFF1A</span>
<span class="token comment">#192.168.2.134:6850\u662F\u65B0\u589E\u7684\u8282\u70B9</span>
<span class="token comment">#192.168.2.136:6850\u96C6\u7FA4\u4EFB\u4E00\u4E2A\u65E7\u8282\u70B9</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6DFB\u52A0\u4ECE\u8282\u70B9</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>redis-cli <span class="token parameter variable">--cluster</span> add-node <span class="token number">192.168</span>.2.134:6851 <span class="token number">192.168</span>.2.145:6850 --cluster-slave --cluster-master-id 9dc220f824f1e8a244721f7dac186d0ea3bf743c
<span class="token comment">#\u6CE8\u91CA\uFF1A</span>
<span class="token comment">#--cluster-slave\uFF0C\u8868\u793A\u6DFB\u52A0\u7684\u662F\u4ECE\u8282\u70B9</span>
<span class="token comment">#--cluster-master-id 9dc220f824f1e8a244721f7dac186d0ea3bf743c,\u4E3B\u8282\u70B9\u7684node id</span>
<span class="token comment">#192.168.2.134:6851,\u65B0\u8282\u70B9</span>
<span class="token comment">#192.168.2.145:6850\u96C6\u7FA4\u4EFB\u4E00\u4E2A\u65E7\u8282\u70B9</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="redis\u538B\u529B\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#redis\u538B\u529B\u6D4B\u8BD5" aria-hidden="true">#</a> redis\u538B\u529B\u6D4B\u8BD5</h3><p><strong>redis-benchmark</strong></p><blockquote><p>redis\u57FA\u51C6\u4FE1\u606F\uFF0Credis\u670D\u52A1\u5668\u6027\u80FD\u68C0\u6D4B</p><p>100\u4E2A\u5E76\u53D1\u8FDE\u63A5\uFF0C100000\u4E2A\u8BF7\u6C42\uFF0C\u68C0\u6D4Bhost\u4E3Alocalhost \u7AEF\u53E3\u4E3A6379\u7684redis\u670D\u52A1\u5668\u6027\u80FD</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>redis-benchmark <span class="token parameter variable">-h</span> localhost <span class="token parameter variable">-p</span> <span class="token number">6379</span> <span class="token parameter variable">-c</span> <span class="token number">100</span> <span class="token parameter variable">-n</span> <span class="token number">100000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="docker\u542F\u52A8redis" tabindex="-1"><a class="header-anchor" href="#docker\u542F\u52A8redis" aria-hidden="true">#</a> docker\u542F\u52A8redis</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">--name</span> redis-6811 <span class="token punctuation">\\</span>
<span class="token parameter variable">-p</span> <span class="token number">192.168</span>.2.138:6811:6811 <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> /data/docker/redis/conf/redis6-6811.conf:/etc/redis/redis.conf <span class="token punctuation">\\</span>
<span class="token parameter variable">-v</span> /data/docker/redis/log/:/var/log/redis/ <span class="token punctuation">\\</span>
<span class="token parameter variable">-d</span> redis:5.0.14 redis-server /etc/redis/redis.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,68),r=[i];function c(p,t){return n(),e("div",null,r)}var m=s(l,[["render",c],["__file","redis.html.vue"]]);export{m as default};
