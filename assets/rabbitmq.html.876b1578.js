import{_ as n}from"./plugin-vue_export-helper.21dcd24c.js";import{o as s,c as a,e}from"./app.c81d5c88.js";const t={},i=e(`<h1 id="rabbitmq" tabindex="-1"><a class="header-anchor" href="#rabbitmq" aria-hidden="true">#</a> rabbitmq</h1><blockquote><p>rabbitmq\u7684\u90E8\u7F72\uFF0C\u96C6\u7FA4\u914D\u7F6E\uFF0C\u5E38\u7528\u547D\u4EE4\u7B49</p></blockquote><h2 id="docker\u90E8\u7F72rabbitmq" tabindex="-1"><a class="header-anchor" href="#docker\u90E8\u7F72rabbitmq" aria-hidden="true">#</a> docker\u90E8\u7F72rabbitmq</h2><blockquote><p>\u90E8\u7F72\u5728\u5185\u7F51\u4E24\u4E2A\u8282\u70B9\uFF0C\u4F7F\u7528\u955C\u50CF\u96C6\u7FA4\u914D\u7F6E</p><p>\u76EE\u5F55\u7ED3\u6784</p></blockquote><h3 id="\u4E24\u53F0\u673A\u751F\u6210\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u4E24\u53F0\u673A\u751F\u6210\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> \u4E24\u53F0\u673A\u751F\u6210\u914D\u7F6E\u6587\u4EF6</h3><p>node1</p><p>docker-compose.yml</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#39;3.8&#39;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> rabbitmq<span class="token punctuation">:</span>3.12.8<span class="token punctuation">-</span>management
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> rabbitmq
    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>HOSTNAME<span class="token punctuation">}</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped
    <span class="token key atrule">mem_limit</span><span class="token punctuation">:</span> 8g        <span class="token comment"># \u9650\u5236\u6700\u591A\u4F7F\u7528 8GB \u5185\u5B58</span>
    <span class="token key atrule">cpus</span><span class="token punctuation">:</span> <span class="token number">6</span>              <span class="token comment"># \u9650\u5236\u6700\u591A\u4F7F\u7528 8 \u4E2A CPU</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;5672:5672&quot;</span>  <span class="token comment"># AMQP\u534F\u8BAE\u7AEF\u53E3</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;15672:15672&quot;</span>  <span class="token comment"># \u7BA1\u7406\u754C\u9762\u7AEF\u53E3</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;4369:4369&quot;</span> <span class="token comment"># \u96C6\u7FA4\u901A\u4FE1\u7AEF\u53E3</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;25672:25672&quot;</span> <span class="token comment"># \u96C6\u7FA4\u901A\u4FE1\u7AEF\u53E3</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">RABBITMQ_DEFAULT_USER</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>USER<span class="token punctuation">}</span>
      <span class="token key atrule">RABBITMQ_DEFAULT_PASS</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>PASS<span class="token punctuation">}</span>
      <span class="token key atrule">RABBITMQ_ERLANG_COOKIE</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>COOKIE_NAME<span class="token punctuation">}</span>  <span class="token comment"># \u96C6\u7FA4\u901A\u4FE1\u5BC6\u94A5</span>
      <span class="token key atrule">RABBITMQ_NODENAME</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>NODENAME<span class="token punctuation">}</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> $<span class="token punctuation">{</span>DATA_PATH<span class="token punctuation">}</span><span class="token punctuation">:</span>/var/lib/rabbitmq  <span class="token comment"># \u6570\u636E\u6301\u4E45\u5316</span>
    <span class="token key atrule">extra_hosts</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> $<span class="token punctuation">{</span>EXTRA_HOSTS<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>node1 .env</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>DATA_PATH=/data/rabbitmq/data
NODENAME=rabbit@node1
HOSTNAME=node1
COOKIE_NAME=jobui_rabbit
USER=jobui
PASS=jobui123
CLUSTER_WITH=
EXTRA_HOSTS=node2:192.168.2.139
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>node2 .env</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>DATA_PATH=/data/rabbitmq/data
NODENAME=rabbit@node2
HOSTNAME=node2
COOKIE_NAME=jobui_rabbit
USER=jobui
PASS=jobui123
CLUSTER_WITH=
EXTRA_HOSTS=node1:192.168.2.135
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u5206\u522B\u542F\u52A8\u5BB9\u5668" tabindex="-1"><a class="header-anchor" href="#\u5206\u522B\u542F\u52A8\u5BB9\u5668" aria-hidden="true">#</a> \u5206\u522B\u542F\u52A8\u5BB9\u5668</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u8282\u70B9\u914D\u7F6E\u5199\u5165hosts" tabindex="-1"><a class="header-anchor" href="#\u8282\u70B9\u914D\u7F6E\u5199\u5165hosts" aria-hidden="true">#</a> \u8282\u70B9\u914D\u7F6E\u5199\u5165hosts</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;192.168.2.139 node2&quot;</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> <span class="token parameter variable">-a</span> /etc/hosts <span class="token comment"># node1</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;192.168.2.135 node1&quot;</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> <span class="token parameter variable">-a</span> /etc/hosts <span class="token comment"># node2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="node2\u52A0\u5165\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#node2\u52A0\u5165\u96C6\u7FA4" aria-hidden="true">#</a> node2\u52A0\u5165\u96C6\u7FA4</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> rabbitmq rabbitmqctl stop_app	<span class="token comment"># \u505C\u6B62\u670D\u52A1</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> rabbitmq rabbitmqctl reset <span class="token comment"># \u91CD\u7F6E\u670D\u52A1\uFF08\u4F1A\u6E05\u9664\u6570\u636E\uFF09</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> rabbitmq rabbitmqctl join_cluster rabbit@node1 <span class="token comment"># \u52A0\u5165\u8282\u70B9</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> rabbitmq rabbitmqctl start_app <span class="token comment"># \u542F\u52A8\u670D\u52A1</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> rabbitmq rabbitmqctl cluster_status <span class="token comment"># \u67E5\u770B\u96C6\u7FA4\u72B6\u6001</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u914D\u7F6E\u955C\u50CF\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u955C\u50CF\u96C6\u7FA4" aria-hidden="true">#</a> \u914D\u7F6E\u955C\u50CF\u96C6\u7FA4</h3><p>\u5728\u4EFB\u610F\u8282\u70B9\u6267\u884C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> rabbitmq rabbitmqctl set_policy ha-all <span class="token string">&quot;^&quot;</span> <span class="token string">&#39;{&quot;ha-mode&quot;:&quot;all&quot;}&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u914D\u7F6E\u9632\u706B\u5899" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u9632\u706B\u5899" aria-hidden="true">#</a> \u914D\u7F6E\u9632\u706B\u5899</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> firewall-cmd <span class="token parameter variable">--permanent</span> <span class="token parameter variable">--zone</span><span class="token operator">=</span>trusted --add-source<span class="token operator">=</span><span class="token number">192.168</span>.2.0/24
<span class="token function">sudo</span> firewall-cmd <span class="token parameter variable">--reload</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,23),l=[i];function c(p,o){return s(),a("div",null,l)}var d=n(t,[["render",c],["__file","rabbitmq.html.vue"]]);export{d as default};
